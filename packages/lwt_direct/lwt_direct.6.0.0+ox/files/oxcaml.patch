diff --git a/src/ppx/ppx_lwt.ml b/src/ppx/ppx_lwt.ml
index 063c01488..c897bcd97 100644
--- a/src/ppx/ppx_lwt.ml
+++ b/src/ppx/ppx_lwt.ml
@@ -10,7 +10,7 @@ let with_loc f {txt ; loc } =
 let is_catchall case =
   let rec is_catchall_pat p = match p.ppat_desc with
     | Ppat_any | Ppat_var _ -> true
-    | Ppat_alias (p, _) | Ppat_constraint (p,_) -> is_catchall_pat p
+    | Ppat_alias (p, _) | Ppat_constraint (p,_,_) -> is_catchall_pat p
     | _ -> false
   in
   case.pc_guard = None && is_catchall_pat case.pc_lhs
@@ -113,7 +113,7 @@ let lwt_expression mapper exp attributes ext_loc =
   | Pexp_sequence (lhs, rhs) ->
     Some (lwt_sequence mapper ~exp ~lhs ~rhs ~ext_loc)
   (* [let%lwt $p$ = $e$ in $e'$] â‰¡ [Lwt.bind $e$ (fun $p$ -> $e'$)] *)
-  | Pexp_let (Nonrecursive, vbl , e) ->
+  | Pexp_let (_, Nonrecursive, vbl , e) ->
     let new_exp =
       pexp_let
         ~loc:!default_loc
@@ -153,7 +153,7 @@ let lwt_expression mapper exp attributes ext_loc =
             [%e pexp_constant ~loc (Pconst_integer (string_of_int loc.loc_start.pos_lnum, None))]
             (fun exn -> try Lwt.reraise exn with exn -> exn)
             [%e e]
-            [%e pexp_function_cases ~loc cases]]
+            [%e pexp_function ~loc cases]]
       | _  ->
         let loc = !default_loc in
         [%expr
@@ -162,8 +162,8 @@ let lwt_expression mapper exp attributes ext_loc =
             [%e pexp_constant ~loc (Pconst_integer (string_of_int loc.loc_start.pos_lnum, None))]
             (fun exn -> try Lwt.reraise exn with exn -> exn)
             (fun () -> [%e e])
-            [%e pexp_function_cases ~loc cases]
-            [%e pexp_function_cases ~loc exns]]
+            [%e pexp_function ~loc cases]
+            [%e pexp_function ~loc exns]]
     in
     Some (mapper#expression { new_exp with pexp_attributes })

@@ -259,7 +259,7 @@ let lwt_expression mapper exp attributes ext_loc =
             [%e pexp_constant ~loc (Pconst_integer (string_of_int loc.loc_start.pos_lnum, None))]
             (fun exn -> try Lwt.reraise exn with exn -> exn)
             (fun () -> [%e expr])
-            [%e pexp_function_cases ~loc cases]
+            [%e pexp_function ~loc cases]
         ]
     in
     Some (mapper#expression { new_exp with pexp_attributes })
@@ -289,7 +289,7 @@ let lwt_expression mapper exp attributes ext_loc =
         [%e pexp_constant ~loc (Pconst_integer (string_of_int loc.loc_start.pos_lnum, None))]
         (fun exn -> try Lwt.reraise exn with exn -> exn)
         [%e cond]
-        [%e pexp_function_cases ~loc cases]]
+        [%e pexp_function ~loc cases]]
     in
     Some (mapper#expression { new_exp with pexp_attributes })

diff --git a/src/unix/lwt_unix.cppo.ml b/src/unix/lwt_unix.cppo.ml
index b014e4ffc..ecec81619 100644
--- a/src/unix/lwt_unix.cppo.ml
+++ b/src/unix/lwt_unix.cppo.ml
@@ -1549,7 +1549,7 @@ let recv ch buf pos len flags =
   if pos < 0 || len < 0 || pos > Bytes.length buf - len then
     invalid_arg "Lwt_unix.recv"
   else
-    let do_recv = if Sys.win32 then Unix.recv else stub_recv in
+    let do_recv fd buf pos len fl = if Sys.win32 then Unix.recv fd buf pos len fl else stub_recv fd buf pos len fl in
     wrap_syscall Read ch (fun () -> do_recv ch.fd buf pos len flags)

 external stub_send : Unix.file_descr -> Bytes.t -> int -> int -> Unix.msg_flag list -> int = "lwt_unix_send"
@@ -1558,7 +1558,7 @@ let send ch buf pos len flags =
   if pos < 0 || len < 0 || pos > Bytes.length buf - len then
     invalid_arg "Lwt_unix.send"
   else
-    let do_send = if Sys.win32 then Unix.send else stub_send in
+    let do_send fd buf pos len fl = if Sys.win32 then Unix.send fd buf pos len fl else stub_send fd buf pos len fl in
     wrap_syscall Write ch (fun () -> do_send ch.fd buf pos len flags)

 external stub_recvfrom : Unix.file_descr -> Bytes.t -> int -> int -> Unix.msg_flag list -> int * Unix.sockaddr = "lwt_unix_recvfrom"
@@ -1567,7 +1567,7 @@ let recvfrom ch buf pos len flags =
   if pos < 0 || len < 0 || pos > Bytes.length buf - len then
     invalid_arg "Lwt_unix.recvfrom"
   else
-    let do_recvfrom = if Sys.win32 then Unix.recvfrom else stub_recvfrom in
+    let do_recvfrom fd buf pos len fl = if Sys.win32 then Unix.recvfrom fd buf pos len fl else stub_recvfrom fd buf pos len fl in
     wrap_syscall Read ch (fun () -> do_recvfrom ch.fd buf pos len flags)

 external stub_sendto : Unix.file_descr -> Bytes.t -> int -> int -> Unix.msg_flag list -> Unix.sockaddr -> int = "lwt_unix_sendto_byte" "lwt_unix_sendto"
@@ -1576,7 +1576,7 @@ let sendto ch buf pos len flags addr =
   if pos < 0 || len < 0 || pos > Bytes.length buf - len then
     invalid_arg "Lwt_unix.sendto"
   else
-    let do_sendto = if Sys.win32 then Unix.sendto else stub_sendto in
+    let do_sendto fd buf pos len fl a = if Sys.win32 then Unix.sendto fd buf pos len fl a else stub_sendto fd buf pos len fl a in
     wrap_syscall Write ch (fun () -> do_sendto ch.fd buf pos len flags addr)

 external stub_recv_msg :
